<div class="container">
  <% if flash[:message] %>
    <h3 class="flash-field text-center"><%= flash[:message]%></h3>
  <% end %>
  <div class="row hotel-row-show align-items-center">
    <hr>
    <div class="col-sm" id="hotel-img">
      <%= image_tag (@hotel.image_url), alt: "#{@hotel.name}" %>
    </div>
    <div class="col-md-6" id="hotel-info">
      <h4><%= @hotel.name %></h4>
      <p><%= @hotel.city.upcase %></p>
      <p><%= @hotel.address %></p>
    </div>
    <div class="col-sm" id="hotel-price">
      <h2>&#36;<%= @hotel.price %></h2>
      <p>per night</p>
    </div>
  </div>

  <h4 class="text-center">From</h4>
  <div class="availablity-form text-center">
    <h5 id="visit-dates"><%= format_start_visit(@visit) %> - <%= format_end_visit(@visit) %></h5>

    <%= form_tag ("/users/#{@user.id}/visits/#{@visit.id}"), method: "delete" do %>
      <%= link_to "MY TRIPS", user_visits_path(@user), class: "btn btn-primary", id: "home-btn" %>
      <%= submit_tag "DELETE TRIP", class: "btn btn-danger" %>
      <% if @user.visits.length > 1 %>
        <%= hidden_field_tag "user_id", "#{@user.id}" %>
        <%= hidden_field_tag "visit_id", "#{@visit.id}" %>
        <%= link_to "NEXT VISIT", "#", class: "btn btn-primary", id: "next-btn" %>
      <% end %>  
    <% end %>
  </div>


  <script
    src="http://code.jquery.com/jquery-3.2.1.js"
    integrity="sha256-DZAnKJ/6XZ9si04Hgrsxu/8s717jcIzLy3oi35EouyE="
    crossorigin="anonymous"></script>

  <script type="text/javascript" charset="utf-8">
    $(function() {
      $('#next-btn').click(function(e) {
        e.preventDefault()
        let user_id = $('#user_id').val()
        let visit_id = $('#visit_id').val()
        let url = `http://localhost:3000/users/${user_id}/visits/${visit_id}/next`
        fetch(url)
          .then(res => res.json())
          .then(function(json) {
            console.log(json)
            let visit = new VisitWithHotel(json)
            visit.nextVisit()
          })
      })
    })
  </script>

  <!-- $(function() {
    $("#create-visit").submit(function(e) {
      e.preventDefault()
      let hotel_id = $('#hotel_id').val()
      let user_id = $('#user_id').val()
      let start_visit = $('#start_visit').val()
      let end_visit = $('#end_visit').val()
      let url = `http://localhost:3000/hotels/${hotel_id}/visits/last`
      let data = {
        user_id: user_id,
        hotel_id: hotel_id,
        start_visit: start_visit,
        end_visit: end_visit
      }
       // fetch(`http://localhost:3000/hotels/${hotel_id}/visits/last`, {
       //    method: 'PATCH',
       //    body: JSON.stringify(data),
       //    headers: { 'Content-Type': 'application/json' }
       // })
       //  .then(res => res.json())
       //  .then(json => console.log(json))
       $.ajax({
          url : url,
          data : JSON.stringify(data),
          type : 'POST',
          contentType : 'application/json',
          processData: false,
          dataType: 'json'
        }).done(function(json) { let visit = new Visit(json)
          visit.render()
        })
    })
  }) -->
